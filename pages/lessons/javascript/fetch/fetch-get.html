<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Hier linken we onze CSS stylesheet aan deze html pagina -->
    <link rel="stylesheet" href="/styles/style.css" type="text/css" />
    <title>Fetch: GET</title>
  </head>
  <body>
    <div class="info-page-container">
      <div class="header">
        <h1 class="title">Fetch: GET</h1>
        <img
          class="label-img"
          src="/imgs/need-to-know.png"
          alt="Need to know"
        />
      </div>

      <div class="link-bar">
        <a href="/pages/lessons/javascript/fetch/introduction.html"
          >Introductie</a
        >
        <a href="/pages/lessons/javascript/fetch/fetch-get.html">Fetch GET</a>
      </div>

      <div class="paragraph">
        <p>
          Met een GET request kunnen we data ophalen van een server. Dit is de
          meest gebruikte HTTP request methode.
        </p>
      </div>

      <div class="paragraph card">
        <h2 class="subtitle">Fetch GET</h2>
        <p>
          Om een GET request te maken met de Fetch API, moeten we een URL
          meegeven aan de fetch functie. De fetch functie retourneert een
          promise die een response object bevat. Om de data uit de response te
          halen, moeten we de <code>.json()</code> methode aanroepen op het
          response object. De <code>.json()</code> methode retourneert een
          promise die de data bevat.
        </p>
        <pre>
<code>
fetch('https://jsonplaceholder.typicode.com/posts/1')
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error(error));
</code>
</pre>
      </div>

      <div class="paragraph card">
        <h2 class="subtitle">Async - Await</h2>
        <p>
          Fetch is gebaseerd op het Async - Await principe. Je kan dan ook van
          die keywords gebruik maken:
        </p>
        <pre>
<code>
const fetchData = async () =>  {
    const response = await fetch('https://stapi.co/api/v1/rest/character?uid=CHMA0000289509');
    const data = await response.json();
    console.log(data);
}

fetchData();
</code>
</pre>
        <p>We maken een asynchrone functie aan.</p>
        <p>
          In deze context betekent "asynchroon" dat de code niet blokkeert
          terwijl het wacht op een operatie om te voltooien, zoals het ophalen
          van data van een API. In plaats daarvan kan de code doorgaan met het
          uitvoeren van andere taken terwijl het wacht op de voltooiing van de
          fetch-operatie.
        </p>
        <p>
          Hier is een stap-voor-stap uitleg van de asynchrone code in het
          voorbeeld:
        </p>
        <ul>
          <li>
            Async Function: De functie fetchData is gemarkeerd met het
            <code class="purple">async</code> keyword, wat aangeeft dat deze
            functie asynchrone operaties bevat en een
            <code class="good">Promise</code> retourneert.
          </li>
          <li>
            Await Keyword: Binnen de fetchData functie wordt het
            <code class="purple">await</code> keyword gebruikt om te wachten op
            de voltooiing van de fetch operatie. Dit betekent dat de code binnen
            de functie pauzeert totdat de fetch operatie voltooid is, maar
            andere code buiten deze functie kan doorgaan met uitvoeren.
          </li>
          <li>
            JSON Parsing: Nadat de fetch operatie voltooid is, wordt de response
            omgezet naar JSON met <code>await response.json()</code>. Ook hier
            wordt await gebruikt om te wachten op de voltooiing van deze
            operatie.
          </li>
          <li>
            Logging Data: Uiteindelijk wordt de verkregen data gelogd naar de
            console.
          </li>
          <li>
            Functie Aanroepen: De fetchData functie wordt aangeroepen om de
            asynchrone operatie te starten.
          </li>
        </ul>
      </div>

      <div class="paragraph card">
        <h2 class="subtitle">Error-handling</h2>
        <p>
          Het is belangrijk om error-handling toe te voegen aan je fetch
          operaties om te voorkomen dat je applicatie vastloopt of onverwachte
          fouten veroorzaakt.
        </p>
        <p>
          Wanneer je met de <code>.then</code> methode werkt, kan je een
          <code>.catch</code> methode toevoegen om eventuele fouten af te
          vangen.
        </p>
        <p>
          Doorgaans is het aangenamer om met de <code class="purple">asyn</code> en
          <code class="purple">await</code> keywords te werken. Dit is leesbaarder en
          vergelijkbaar met hoe je in C# asynchroon programmeert.
        </p>
        <p>
          Bij deze manier van werken kan je gebruik maken van een
          <code class="purple">try</code> en
          <code class="purple">catch</code> blok om fouten af te vangen.
        </p>
        <pre>
<code>
const fetchData = async () =>  {
    try {
        const response = await fetch('https://stapi.co/api/v1/rest/character');
        const data = await response.json();
        console.log(data);
    } catch (error) {
        console.error(error);
    }
}

fetchData();
</code>
</pre>
        <p>
          Deze fetch call is er eentje die opzettelijk faalt. De API verwacht
          een paramater <code>uid</code>. Als je deze niet meegeeft, krijg je
          een error terug.
        </p>
        <p>
          Omdat we die in de <code class="purple">catch</code> block afvangen en loggen,
          krijgen we de error te zien in de console. Dit is een goede manier om
          te zien wat er fout gaat in je fetch operatie.
        </p>
      </div>

      <div class="paragraph card">
        <h2 class="subtitle">Gratis REST API's</h2>
        <ul>
          <li>
            <a
              href="https://editor.swagger.io/?url=https://stapi.co/api/v1/rest/common/download/stapi.yaml"
              target="_blank"
              >Star Trek API</a
            >
          </li>
          <li>
            <a href="https://swapi.dev/" target="_blank">Star Wars API</a>
          </li>
          <li>
            <a href="https://www.thecocktaildb.com/api.php" target="_blank"
              >Cocktail API</a
            >
          </li>
          <li>
            <a href="https://docs.zippopotam.us/" target="_blank"
              >Zippopotam </a
            >
          </li>
        </ul>
        Je kan deze APIs gemakkelijk uitproberen met
        <a href="https://www.postman.com/downloads/" target="_blank">Postman</a
        >.
      </div>

      <a id="back-to-top" href="#">Terug naar boven</a>
    </div>
  </body>
</html>
